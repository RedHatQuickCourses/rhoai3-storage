<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>The Physics of AI Storage :: The Storage Strategy, Architecting for AI Scale</title>
    <link rel="prev" href="section1.html">
    <link rel="next" href="storage-lab.html">
    <meta name="description" content="Understanding the impact of storage protocols on Node I/O, Caching, and Pod Stability.">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">The Storage Strategy, Architecting for AI Scale</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/REPLACEREPONAME/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="rhoai3-storage" data-version="3.2">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">The Storage Strategy, Architecting for AI Scale</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Introduction &amp; Value</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="section1.html">Architecture Deep Dive</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="section3.html">Data Connection Types</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="storage-lab.html">Data and Cluster Connections</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="section2.html">Lab: Review for Inclusion</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="section5.html">Field Notes for Platform Engineers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="quiz.html">Quiz</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">The Storage Strategy, Architecting for AI Scale</span>
    <span class="version">3.2</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">The Storage Strategy, Architecting for AI Scale</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">3.2</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">The Storage Strategy, Architecting for AI Scale</a></li>
    <li><a href="section3.html">Data Connection Types</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">The Physics of AI Storage</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph lead">
<p><strong>To build a stable platform, you must respect the physics of the underlying infrastructure.</strong></p>
</div>
<div class="paragraph">
<p>In standard web development, a 500MB container image is considered "large." In AI, a 70GB model is considered "medium."</p>
</div>
<div class="paragraph">
<p>When you try to move objects of this size using standard Kubernetes patterns, things break. Nodes run out of disk space. Networks saturate. Pods enter crash loops.</p>
</div>
<div class="paragraph">
<p>This module breaks down the <strong>Three Storage Tiers</strong> of RHOAI 3 and explains the mechanical differences between them so you can architect for stability.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_1_the_emptydir_problem_why_s3_fails_at_scale"><a class="anchor" href="#_1_the_emptydir_problem_why_s3_fails_at_scale"></a>1. The "EmptyDir" Problem (Why S3 Fails at Scale)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The most common mistake Platform Engineers make is treating Object Storage (S3) as a universal solution for Model Serving.</p>
</div>
<div class="paragraph">
<p>When a Model Server connects to an S3 bucket to load a model, it typically follows this workflow:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Init:</strong> An <code>initContainer</code> starts.</p>
</li>
<li>
<p><strong>Download:</strong> It pulls the 50GB model file from S3.</p>
</li>
<li>
<p><strong>Write:</strong> It writes that file to an <code>emptyDir</code> volume (ephemeral storage) on the Node&#8217;s disk.</p>
</li>
<li>
<p><strong>Serve:</strong> The main container mounts that volume and loads the model into RAM.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_the_architectural_risk"><a class="anchor" href="#_the_architectural_risk"></a>The Architectural Risk</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Node Thrashing:</strong> If you schedule 4 replicas of a 50GB model on one node, you just demanded <strong>200GB of ephemeral disk space</strong>. If the node doesn&#8217;t have it, the Kubelet will start <strong>evicting pods</strong>.</p>
</li>
<li>
<p><strong>Bandwidth Storms:</strong> If a node reboots, all 4 pods restart and try to download 200GB simultaneously, saturating the network interface.</p>
</li>
<li>
<p><strong>Latency:</strong> The pod is not "Ready" until the download finishes. This can take 10-20 minutes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Strategic Rule:</strong> Use S3 for <strong>Training Data</strong> (Ingestion). Do not use it for <strong>Production Serving</strong> of large models.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_2_the_velocity_tier_oci_modelcars_the_solution"><a class="anchor" href="#_2_the_velocity_tier_oci_modelcars_the_solution"></a>2. The Velocity Tier: OCI Modelcars (The Solution)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To solve the "EmptyDir" problem, RHOAI 3 supports the <strong>OCI Protocol</strong> (Modelcars). This treats the model not as a <strong>file</strong>, but as a <strong>Container Image</strong>.</p>
</div>
<div class="sect2">
<h3 id="_the_physics_of_oci"><a class="anchor" href="#_the_physics_of_oci"></a>The Physics of OCI</h3>
<div class="paragraph">
<p>When you define a Data Connection with <code>opendatahub.io/connection-type-protocol: "oci"</code>, the cluster uses the underlying container runtime (CRI-O) to pull the data.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Layer Caching:</strong> If 10 replicas start on the same node, CRI-O pulls the image layers <strong>once</strong>. All 10 pods share the read-only layer on the disk.</p>
</li>
<li>
<p><strong>Zero Duplication:</strong> You use 50GB of disk space, not 500GB.</p>
</li>
<li>
<p><strong>Instant Startup:</strong> If the image is already cached on the node, startup time is near-instant.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_3_the_persistence_tier_cluster_storage_pvcs"><a class="anchor" href="#_3_the_persistence_tier_cluster_storage_pvcs"></a>3. The Persistence Tier: Cluster Storage (PVCs)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While OCI is for speed, <strong>Persistent Volume Claims (PVCs)</strong> are for <strong>state</strong> and <strong>isolation</strong>.</p>
</div>
<div class="sect2">
<h3 id="_rwo_vs_rwx_the_physics_of_access"><a class="anchor" href="#_rwo_vs_rwx_the_physics_of_access"></a>RWO vs. RWX: The Physics of Access</h3>
<div class="paragraph">
<p>You must choose the right Access Mode based on the physics of your storage backend.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Access Mode</th>
<th class="tableblock halign-left valign-top">The Analogy</th>
<th class="tableblock halign-left valign-top">The Architectural Constraint</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ReadWriteOnce (RWO)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>The Hard Drive</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Block Storage.</strong> It physical mounts a block device to a specific Node. It cannot be mounted to two nodes at once. If the pod moves, the drive must unmount and remount.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Best For:</strong> User Scratchpads, Databases, Single-User Notebooks.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ReadWriteMany (RWX)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>The File Server</strong></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_the_retain_policy_critical_safety"><a class="anchor" href="#_the_retain_policy_critical_safety"></a>The "Retain" Policy (Critical Safety)</h3>
<div class="paragraph">
<p>By default, when a user deletes a PVC, Kubernetes <strong>deletes the data</strong>.
For "Golden Datasets" or "Production Models" stored on PVCs, you must change the <code>ReclaimPolicy</code> to <code>Retain</code>. This ensures that even if a namespace is nuked, the underlying storage remains safe.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_4_the_abstraction_tier_the_api_primitives"><a class="anchor" href="#_4_the_abstraction_tier_the_api_primitives"></a>4. The Abstraction Tier: The API Primitives</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To configure any of the above, RHOAI 3 uses two specific API resources.</p>
</div>
<div class="sect2">
<h3 id="_a_the_connection_type_the_template"><a class="anchor" href="#_a_the_connection_type_the_template"></a>A. The Connection Type (The Template)</h3>
<div class="paragraph">
<p>An administrator-defined resource that dictates the <strong>schema</strong> of a connection.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Purpose:</strong> Governance. It forces users to provide specific fields (e.g., "Endpoint", "Region").</p>
</li>
<li>
<p><strong>Role:</strong> The Platform Engineer creates this <strong>once</strong>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_b_the_data_connection_the_instance"><a class="anchor" href="#_b_the_data_connection_the_instance"></a>B. The Data Connection (The Instance)</h3>
<div class="paragraph">
<p>A Kubernetes Secret that contains the actual credentials.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Purpose:</strong> Injection. It maps the values to Environment Variables inside the Pod.</p>
</li>
<li>
<p><strong>Role:</strong> The User (or Automation Script) creates this <strong>per project</strong>.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="title">Deprecation Alert</div>
<div class="paragraph">
<p>RHOAI 3 has standardized the annotations.
 * <strong>Deprecated:</strong> <code>opendatahub.io/connection-type-ref</code>
 * <strong>Required:</strong> <code>opendatahub.io/connection-type-protocol</code> (Values: <code>s3</code>, <code>oci</code>, <code>uri</code>)</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_summary_the_decision_matrix"><a class="anchor" href="#_summary_the_decision_matrix"></a>Summary: The Decision Matrix</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As a Platform Engineer, here is your decision tree:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Ingesting Raw Data?</strong> &#8594; <strong>S3 Connection.</strong></p>
</li>
<li>
<p><strong>Serving Large Models in Production?</strong> &#8594; <strong>OCI Connection</strong> (for caching).</p>
</li>
<li>
<p><strong>Collaborating with a Team?</strong> &#8594; <strong>RWX PVC.</strong></p>
</li>
<li>
<p><strong>Air-Gapped Environment?</strong> &#8594; <strong>RWX PVC</strong> (with <code>Retain</code> policy).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Now that we understand the physics, let&#8217;s look at the "Sharp Edges"â€”the specific configurations that cause outages.</strong></p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="section1.html">Architecture Deep Dive</a></span>
  <span class="next"><a href="storage-lab.html">Data and Cluster Connections</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
