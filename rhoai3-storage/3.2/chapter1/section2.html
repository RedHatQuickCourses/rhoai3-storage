<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Lab: Automating the Data Supply Chain :: The Storage Strategy, Architecting for AI Scale</title>
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">The Storage Strategy, Architecting for AI Scale</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/REPLACEREPONAME/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="rhoai3-storage" data-version="3.2">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">The Storage Strategy, Architecting for AI Scale</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Introduction &amp; Value</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="section1.html">Architecture Deep Dive</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="section3.html">Data Connection Types</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="storage-lab.html">Data and Cluster Connections</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="section5.html">Field Notes for Platform Engineers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="quiz.html">Quiz</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">The Storage Strategy, Architecting for AI Scale</span>
    <span class="version">3.2</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">The Storage Strategy, Architecting for AI Scale</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">3.2</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">The Storage Strategy, Architecting for AI Scale</a></li>
    <li><a href="section2.html">Lab: Automating the Data Supply Chain</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Lab: Automating the Data Supply Chain</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><strong>Stop clicking. Start engineering.</strong></p>
</div>
<div class="paragraph">
<p>To build a Data Supply Chain, you first need a "Warehouse" (Object Storage) and a "Brain" (Metadata Storage). In a real corporate environment, these already exist. In this lab, we will simulate that environment by deploying a real instance of <strong>MinIO</strong> and <strong>MySQL</strong> to your cluster in seconds.</p>
</div>
<div class="paragraph">
<p>Once the infrastructure is live, you will act as the <strong>Platform Architect</strong>. You will define the "Universal Adapters" (Data Connections) that allow your Data Scientists to consume these resources securely, without ever knowing the root passwords.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a>Prerequisites</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Access to an OpenShift cluster with <strong>RHOAI 3</strong> installed.</p>
</li>
<li>
<p><code>cluster-admin</code> privileges.</p>
</li>
<li>
<p>The <code>oc</code> CLI tool installed.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_phase_1_the_infrastructure_deploy_the_factory"><a class="anchor" href="#_phase_1_the_infrastructure_deploy_the_factory"></a>Phase 1: The Infrastructure (Deploy the Factory)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We have packaged the "Plumbing" into a Fast Track script. This script will:
1.  Create the <code>rhoai-model-registry-lab</code> namespace.
2.  Deploy <strong>MinIO</strong> (S3-compatible storage).
3.  Deploy <strong>MySQL</strong> (Relational Database).
4.  Expose them internally to the cluster.</p>
</div>
<div class="sect2">
<h3 id="_1_acquire_the_infrastructure_code"><a class="anchor" href="#_1_acquire_the_infrastructure_code"></a>1. Acquire the Infrastructure Code</h3>
<div class="paragraph">
<p>Create a file named <code>setup.sh</code> and paste the following content. This simulates checking out the "Ops Team" repository.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">#!/bin/bash
# setup.sh: Automates the "Plumbing" phase.
set -e
NAMESPACE="rhoai-model-registry-lab"

echo "ðŸš€ Starting AI Supply Chain Infrastructure Setup..."

# 1. Create Namespace
if oc get project "$NAMESPACE" &gt; /dev/null 2&gt;&amp;1; then
    echo "âœ” Namespace $NAMESPACE exists."
else
    oc new-project "$NAMESPACE"
fi

# 2. Deploy MinIO (The Vault)
echo "âž¤ Deploying MinIO..."
# (In a real lab, these would be git checkout files. Here we apply directly.)
oc apply -f https://raw.githubusercontent.com/RedHatQuickCourses/rhoai3-storage/main/manifests/minio-backend.yaml -n $NAMESPACE

# 3. Deploy MySQL (The Brain)
echo "âž¤ Deploying MySQL..."
oc apply -f https://raw.githubusercontent.com/RedHatQuickCourses/rhoai3-storage/main/manifests/mysql-backend.yaml -n $NAMESPACE

echo "âœ… Infrastructure Setup Complete!"
echo "MinIO URL: http://minio-service.$NAMESPACE.svc.cluster.local:9000"
echo "MySQL Host: mysql.$NAMESPACE.svc.cluster.local"</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>(Note: For this lab, assume the YAML files referenced in the script are available locally or apply the provided sample files.)</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="_2_execute_the_provisioning"><a class="anchor" href="#_2_execute_the_provisioning"></a>2. Execute the Provisioning</h3>
<div class="paragraph">
<p>Run the script to stand up the factory floor.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">chmod +x setup.sh
./setup.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Validation:</strong>
Check that your "Warehouse" is running.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc get pods -n rhoai-model-registry-lab</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Expected Output:</strong> You should see <code>minio</code> and <code>mysql</code> pods in <code>Running</code> state.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_phase_2_the_universal_adapter_gitops_connections"><a class="anchor" href="#_phase_2_the_universal_adapter_gitops_connections"></a>Phase 2: The Universal Adapter (GitOps Connections)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that the servers are running, we need to create the "Plugs" that allow RHOAI to connect to them. We will use a <strong>GitOps approach</strong> to ensure these connections are standardized and reproducible.</p>
</div>
<div class="sect2">
<h3 id="_step_1_define_the_s3_standard_connection_type"><a class="anchor" href="#_step_1_define_the_s3_standard_connection_type"></a>Step 1: Define the S3 Standard (Connection Type)</h3>
<div class="paragraph">
<p>First, we define the "Socket" for our Corporate Data Lake. This tells the RHOAI Dashboard what fields to expect.</p>
</div>
<div class="paragraph">
<p><strong>File:</strong> <code>01-s3-type.yaml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: dashboard.opendatahub.io/v1alpha
kind: ConnectionType
metadata:
  name: corporate-minio-standard
  labels:
    opendatahub.io/dashboard: "true"
spec:
  displayName: "Corporate MinIO Standard"
  category: "Object Storage"
  description: "Standard connection to the internal MinIO Data Lake."
  fields:
    - name: Endpoint
      type: text
      required: true
      envVar: AWS_S3_ENDPOINT
    - name: Bucket
      type: text
      required: true
      envVar: AWS_S3_BUCKET
    - name: Access Key
      type: text
      required: true
      envVar: AWS_ACCESS_KEY_ID
    - name: Secret Key
      type: password
      required: true
      envVar: AWS_SECRET_ACCESS_KEY</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc apply -f 01-s3-type.yaml</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_create_the_data_connection_the_instance"><a class="anchor" href="#_step_2_create_the_data_connection_the_instance"></a>Step 2: Create the Data Connection (The Instance)</h3>
<div class="paragraph">
<p>Now, we create the actual connection for the "Finance Team" that points to the MinIO instance we just deployed. Notice we use the internal ClusterIP service URL.</p>
</div>
<div class="paragraph">
<p><strong>File:</strong> <code>02-finance-connection.yaml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
kind: Secret
metadata:
  name: finance-data-lake
  namespace: rhoai-model-registry-lab
  labels:
    opendatahub.io/dashboard: "true" # &lt;1&gt; Visible in UI
    opendatahub.io/managed: "true"
  annotations:
    opendatahub.io/connection-type: "corporate-minio-standard" # &lt;2&gt; Links to our Type
    openshift.io/display-name: "Finance Data Lake"
type: Opaque
stringData:
  Endpoint: "http://minio-service.rhoai-model-registry-lab.svc.cluster.local:9000"
  Bucket: "finance-records"
  Access Key: "minio"
  Secret Key: "minio123"</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><strong>Required Label:</strong> Without this, the secret is invisible to RHOAI.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><strong>Binding:</strong> This links the secret to the schema we defined in Step 1.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc apply -f 02-finance-connection.yaml</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_phase_3_the_brain_database_connection"><a class="anchor" href="#_phase_3_the_brain_database_connection"></a>Phase 3: The Brain (Database Connection)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RHOAI 3 requires databases for Model Registries. Let&#8217;s wire up the MySQL instance.</p>
</div>
<div class="sect2">
<h3 id="_step_1_define_the_database_standard"><a class="anchor" href="#_step_1_define_the_database_standard"></a>Step 1: Define the Database Standard</h3>
<div class="paragraph">
<p><strong>File:</strong> <code>03-db-type.yaml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: dashboard.opendatahub.io/v1alpha
kind: ConnectionType
metadata:
  name: corporate-mysql
  labels:
    opendatahub.io/dashboard: "true"
spec:
  displayName: "Corporate MySQL"
  category: "Database"
  fields:
    - name: Host
      type: text
      envVar: DB_HOST
    - name: Port
      type: text
      defaultValue: "3306"
      envVar: DB_PORT
    - name: Username
      type: text
      envVar: DB_USER
    - name: Password
      type: password
      envVar: DB_PASSWORD</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc apply -f 03-db-type.yaml</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_create_the_db_connection"><a class="anchor" href="#_step_2_create_the_db_connection"></a>Step 2: Create the DB Connection</h3>
<div class="paragraph">
<p><strong>File:</strong> <code>04-registry-db.yaml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
kind: Secret
metadata:
  name: registry-db-connection
  namespace: rhoai-model-registry-lab
  labels:
    opendatahub.io/dashboard: "true"
  annotations:
    opendatahub.io/connection-type: "corporate-mysql"
    openshift.io/display-name: "Model Registry Database"
type: Opaque
stringData:
  Host: "mysql.rhoai-model-registry-lab.svc.cluster.local"
  Port: "3306"
  Username: "admin"
  Password: "mysql-admin"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc apply -f 04-registry-db.yaml</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_phase_4_verification_the_payoff"><a class="anchor" href="#_phase_4_verification_the_payoff"></a>Phase 4: Verification (The Payoff)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You have successfully used GitOps to wire up a complete Data Supply Chain. Let&#8217;s verify it in the interface.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the <strong>Red Hat OpenShift AI Dashboard</strong>.</p>
</li>
<li>
<p>Navigate to <strong>Data Science Projects</strong>.</p>
</li>
<li>
<p>Select the project <strong>rhoai-model-registry-lab</strong> (created by the script).</p>
</li>
<li>
<p>Click the <strong>Data connections</strong> tab.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Success Criteria:</strong>
* [ ] You see <strong>"Finance Data Lake"</strong> listed under <strong>Object Storage</strong>.
* [ ] You see <strong>"Model Registry Database"</strong> listed under <strong>Database</strong>.
* [ ] The connection details are hidden from view, ensuring security.</p>
</div>
<div class="paragraph">
<p><strong>You have now built a standardized, automated data layer that can be replicated across any environment.</strong></p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
